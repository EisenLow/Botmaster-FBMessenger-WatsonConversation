'use strict';var R=require('ramda'),_require=require('./fulfill'),fulfill=_require.fulfill,debug=require('debug')('botmaster:ware:fulfill'),textLens=R.lensPath(['update','message','text']),defaultUpdateToInput=R.view(textLens),defaultResponseToUpdate=function(a,b){return a.message.text=b?b.trim(' '):'',!1==R.isEmpty(a.message.text)},FulfillWare=function(a){return function(b,c,d){debug('fulfill received update: '+JSON.stringify(c));var _options$actions=a.actions,e=_options$actions===void 0?{}:_options$actions,_options$updateToInpu=a.updateToInput,f=_options$updateToInpu===void 0?defaultUpdateToInput:_options$updateToInpu,_options$responseToUp=a.responseToUpdate,g=_options$responseToUp===void 0?defaultResponseToUpdate:_options$responseToUp,_options$context=a.context,h=_options$context===void 0?{}:_options$context;debug('fulfill using actions: '+JSON.stringify(e)),debug('fulfill using as input: '+f({bot:b,update:c})),h.bot=b,h.update=c,fulfill(a.actions,h,f({bot:b,update:c}),function(i,j){var k=g(c,j);k?(d(i),debug('fulfill sent new update: '+JSON.stringify(c))):debug('no final update to send')})}};module.exports={FulfillWare:FulfillWare};